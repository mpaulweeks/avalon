(this["webpackJsonpavalon-fe"]=this["webpackJsonpavalon-fe"]||[]).push([[0],{23:function(e,t,a){e.exports=a(34)},28:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(20),s=a.n(l),c=(a(28),a(2)),o=a(3),i=a(4),u=a(5),m=a(12),v=a(10);function h(e){return Math.floor(Math.random()*Math.pow(10,e)).toString().padStart(e,"0")}var d=function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,null,[{key:"set",value:function(e){this.store.setItem("state",JSON.stringify(e))}},{key:"get",value:function(){var e=this.store.getItem("state");if(!e){var t={id:h(6)};return this.set(t),t}return JSON.parse(e)}}]),e}();d.store=window.localStorage;var g=window.location.href.includes("localhost")&&!window.location.href.includes("prod")?"ws://localhost:8080":"wss://avalon-272401.appspot.com",f="http"+g.slice(2),p=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).id=d.get().id,n.hasReceived=!1,n.ws=void 0,n.ws=new WebSocket("".concat(g,"/").concat(n.path())),console.log("constructing websocket view for:",n.path()),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.ws.onmessage=function(t){var a=JSON.parse(t.data);e.onReceive(a)},this.ws.onopen=function(){return e.onOpen()}}},{key:"componentWillUnmount",value:function(){this.ws.close()}},{key:"onOpen",value:function(){}},{key:"onReceive",value:function(e){this.setState({data:e})}},{key:"message",value:function(e){this.ws.send(JSON.stringify(e))}}]),a}(r.a.Component),E=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={data:{rss:"?",heapTotal:"?",heapUsed:"?",external:"?"}},e}return Object(o.a)(a,[{key:"path",value:function(){return"memory"}},{key:"render",value:function(){var e=this.state.data;return r.a.createElement("div",null,r.a.createElement("h1",null,"Debugging Health Info"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://mpaulweeks.github.io/avalon/"},"mpaulweeks.github.io/avalon")),r.a.createElement("p",null,r.a.createElement("a",{href:f},f)),Object.keys(e).map((function(t){return r.a.createElement("div",{key:t},t,": ",e[t])})))}}]),a}(p),b=a(8),y=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={data:{showResults:!1,votes:{}}},e}return Object(o.a)(a,[{key:"path",value:function(){return"vote/".concat(d.get().game||0)}},{key:"voteSuccess",value:function(){var e=Object(b.a)({},this.state.data);e.votes[this.id]="success",this.message(e)}},{key:"voteFail",value:function(){var e=Object(b.a)({},this.state.data);e.votes[this.id]="fail",this.message(e)}},{key:"voteClear",value:function(){var e=Object(b.a)({},this.state.data);e.votes={},this.message(e)}},{key:"toggleReveal",value:function(){var e=Object(b.a)({},this.state.data);e.showResults=!e.showResults,this.message(e)}},{key:"render",value:function(){var e=this,t=this.state.data;return d.get().game?r.a.createElement("div",null,r.a.createElement("h1",null,"Vote"),t.votes[this.id]?r.a.createElement("h3",null," you have voted "):r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.voteSuccess()}},"vote SUCCESS"),r.a.createElement("button",{onClick:function(){return e.voteFail()}},"vote FAIL")),r.a.createElement("hr",null),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.voteClear()}},"clear all votes"),r.a.createElement("button",{onClick:function(){return e.toggleReveal()}},t.showResults?"hide":"show"," votes")),r.a.createElement("hr",null),r.a.createElement("h3",null,"results!"),t.showResults&&Object.keys(t.votes).length?r.a.createElement("div",null,Object.keys(t.votes).map((function(e){return r.a.createElement("div",{key:e},e,": ",t.votes[e])}))):r.a.createElement("p",null,Object.keys(t.votes).length," votes counted")):r.a.createElement("h3",null,"you must be in a game to vote")}}]),a}(p),O=a(14),j=["BasicBlue","Merlin","Percival","BasicRed","Assassin","Mordred","Morgana"].reduce((function(e,t){return e[t]=t,e}),{}),k=[j.BasicRed,j.Assassin,j.Morgana],w=k.concat([j.Mordred]),R={BasicBlue:{isRed:!1,name:"Basic Blue",sees:[]},Merlin:{isRed:!1,name:"Merlin",sees:k},Percival:{isRed:!1,name:"Percival",sees:[j.Merlin,j.Morgana]},BasicRed:{isRed:!0,name:"Basic Red",sees:w},Assassin:{isRed:!0,name:"Assassin",sees:w},Mordred:{isRed:!0,name:"Mordred",sees:w},Morgana:{isRed:!0,name:"Morgana",sees:w}},S=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={data:{id:e.props.game,host:e.props.isHost?d.get().id:void 0,roles:[],players:Object(O.a)({},d.get().id,{id:d.get().id,name:d.get().name||"???"})}},e}return Object(o.a)(a,[{key:"path",value:function(){return"game/".concat(d.get().game||0)}},{key:"onOpen",value:function(){this.props.isHost&&this.message(this.state.data)}},{key:"onReceive",value:function(e){console.log("received:",e);var t=this.state.data;t.host||(e.players=Object(b.a)({},t.players,{},e.players),this.message(e)),this.setState({data:e})}},{key:"render",value:function(){var e=this.state.data,t=e.host&&e.players[e.host],a=t?t.name:"???",n=d.get(),l=e.players[n.id]||{name:n.name},s=R[l.role||j.BasicBlue],c=Object.keys(e.players).filter((function(e){return e!==n.id})).map((function(t){return e.players[t]})).filter((function(e){return e.role&&s.sees.includes(e.role)})).map((function(e){return e.name}));return r.a.createElement("div",null,r.a.createElement("h1",null,"Game #",e.id),r.a.createElement("div",null,"host: ",a),r.a.createElement("div",null,"players: ",Object.values(e.players).map((function(e){return e.id+"/"+e.name})).join(", ")),l.role&&r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("div",null,"you are: ",s.name),r.a.createElement("div",null,"you see: ",c.join(", "))))}}]),a}(p),C=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={storage:d.get(),isHost:!1,tempName:"",tempJoin:""},e}return Object(o.a)(a,[{key:"setName",value:function(){d.set(Object(b.a)({},d.get(),{name:this.state.tempName})),this.setState({storage:d.get()})}},{key:"createGame",value:function(){d.set(Object(b.a)({},d.get(),{game:h(3)})),this.setState({storage:d.get(),isHost:!0})}},{key:"joinGame",value:function(){d.set(Object(b.a)({},d.get(),{game:this.state.tempJoin})),this.setState({storage:d.get()})}},{key:"render",value:function(){var e=this,t=this.state,a=t.storage,n=t.isHost,l=t.tempName,s=t.tempJoin;return a.game?r.a.createElement(S,{isHost:n,game:a.game}):a.name?r.a.createElement("div",null,r.a.createElement("h1",null,"Find a Game"),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.createGame()}},"create game")),r.a.createElement("hr",null),r.a.createElement("div",null,r.a.createElement("input",{value:s,onChange:function(t){return e.setState({tempJoin:t.target.value})}}),r.a.createElement("button",{onClick:function(){return e.joinGame()}},"join game"))):r.a.createElement("div",null,r.a.createElement("h1",null,"Enter your name"),r.a.createElement("input",{value:l,onChange:function(t){return e.setState({tempName:t.target.value})}}),r.a.createElement("button",{onClick:function(){return e.setName()}},"confirm"))}}]),a}(r.a.Component),M=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={storage:d.get()},e}return Object(o.a)(a,[{key:"reset",value:function(){d.set({id:h(6),name:void 0,game:void 0}),this.setState({storage:d.get()})}},{key:"render",value:function(){var e=this,t=this.state.storage,a=t.id,n=t.name,l=t.game;return r.a.createElement("div",null,r.a.createElement("h1",null,"Current Local State"),r.a.createElement("h3",null,"id: ",a),r.a.createElement("h3",null,"name: ",n),r.a.createElement("h3",null,"game: ",l),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e.reset()}},"reset everything")))}}]),a}(r.a.Component),B=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement("div",null,r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(m.b,{to:"/"},"Game")),r.a.createElement("li",null,r.a.createElement(m.b,{to:"/vote"},"Vote")),r.a.createElement("li",null,r.a.createElement(m.b,{to:"/reset"},"Reset")),r.a.createElement("li",null,r.a.createElement(m.b,{to:"/debug"},"Debug")))),r.a.createElement(v.c,null,r.a.createElement(v.a,{path:"/vote"},r.a.createElement(y,null)),r.a.createElement(v.a,{path:"/reset"},r.a.createElement(M,null)),r.a.createElement(v.a,{path:"/debug"},r.a.createElement(E,null)),r.a.createElement(v.a,{path:"/"},r.a.createElement(C,null)))))}}]),a}(r.a.Component);s.a.render(r.a.createElement(B,null),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.fdafe2fc.chunk.js.map